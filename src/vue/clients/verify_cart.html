<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart Verification</title>
  <style>
    /* Basic styles to simulate the app */
    body { font-family: sans-serif; margin: 0; padding: 20px; background: #f0f0f0; }
    .cart-backdrop {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.5); display: none; z-index: 100;
    }
    .cart-backdrop.open { display: block; }

    .cart-panel {
      position: fixed; top: 0; right: 0; width: 300px; height: 100%;
      background: white; transform: translateX(100%); transition: transform 0.3s;
      z-index: 101; display: flex; flex-direction: column;
    }
    .cart-panel.open { transform: translateX(0); }

    .cart-header { padding: 1rem; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
    .cart-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; }
    .cart-items { flex: 1; overflow-y: auto; padding: 1rem; }
    .cart-footer { padding: 1rem; border-top: 1px solid #eee; }

    /* Utility classes */
    .btn { padding: 0.5rem 1rem; border: none; cursor: pointer; border-radius: 4px; }
    .btn-primary { background: orange; color: white; }
    .btn-secondary { background: #eee; }
    .btn--full { width: 100%; }

    .empty-state { text-align: center; color: #888; }
    .cart-item { display: flex; gap: 10px; margin-bottom: 1rem; border-bottom: 1px solid #f9f9f9; padding-bottom: 1rem; }
    .cart-item-image { width: 50px; height: 50px; object-fit: cover; background: #ddd; }
    .cart-item-info { flex: 1; }
    .cart-item-controls { display: flex; align-items: center; gap: 5px; margin-top: 5px; }
    .quantity-btn { width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border: 1px solid #ddd; background: white; cursor: pointer; }
    .cart-item-quantity { font-weight: bold; }
    .cart-item-price { margin-left: auto; font-weight: bold; }
    .cart-total { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 1rem; }
    .cart-actions { display: flex; gap: 10px; }

    #cart-count {
        display: none;
        background: red;
        color: white;
        padding: 2px 6px;
        border-radius: 10px;
        position: absolute;
        top: 10px;
        right: 10px;
    }
  </style>
  <script>
    // Mock APP settings
    window.APP_SETTINGS = { currency_locale: 'es-MX', currency_code: 'MXN', currency_symbol: '$' };
    window.APP_CONFIG = {};

    // Mock Global Functions
    window.backToMenu = () => console.log('backToMenu called');
    window.proceedToCheckout = () => console.log('proceedToCheckout called');
    window.showNotification = (msg) => console.log('Notification:', msg);
  </script>
</head>
<body>

  <h1>Cart Verification Harness</h1>
  <button id="open-cart-btn">Open Cart</button>
  <button id="add-item-btn">Add Random Item</button>

  <div id="cart-count">0</div>

  <!-- Mount points expected by base.ts -->
  <div class="cart-backdrop" id="cart-backdrop"></div>
  <div class="cart-panel" id="cart-panel">
      <!-- Original Server Content (Simulated) -->
      <div class="cart-header"><h2>Loading...</h2></div>
  </div>

  <!-- Load Entry Point -->
  <script type="module" src="./entrypoints/base.ts"></script>

  <script type="module">
    import { cartStore } from './store/cart.ts';

    document.getElementById('open-cart-btn').addEventListener('click', () => {
        cartStore.openCart();
    });

    document.getElementById('add-item-btn').addEventListener('click', () => {
        cartStore.addItem({
            id: Date.now(),
            name: 'Test Item ' + Math.floor(Math.random() * 100),
            price: 50 + Math.random() * 50,
            quantity: 1,
            image: '',
            extras: [],
            extrasTotal: 0,
            modifiers: []
        });
    });
  </script>

</body>
</html>
